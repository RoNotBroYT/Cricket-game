<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cricket Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #000 60%, #00eaff 100%);
      font-family: Segoe UI, Arial, sans-serif;
      color: #00eaff;
    }
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 32px;
      min-height: 100vh;
    }
    h2 {
      color: #00eaff;
      margin-bottom: 8px;
      letter-spacing: 2px;
    }
    .info {
      margin-bottom: 12px;
      color: #fff;
      font-size: 1.1rem;
      font-weight: bold;
    }
    .game-btn {
      background: #111;
      color: #00eaff;
      border: 2px solid #00eaff;
      padding: 6px 18px;
      border-radius: 10px;
      font-size: 1rem;
      font-weight: bold;
      margin: 10px 0 20px 0;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      box-shadow: 0 0 16px 0 #00eaff22;
    }
    .game-btn:hover, .game-btn:focus {
      background: #00eaff;
      color: #111;
    }
    canvas {
      background: #10151b;
      border-radius: 16px;
      box-shadow: 0 6px 32px 0 #00eaff55;
      display: block;
      margin-bottom: 14px;
      border: 2px solid #00eaff55;
      outline: none;
    }
    .game-over {
      color: #ff3860;
      font-weight: bold;
      margin-left: 8px;
    }
    .run-announce {
      position: absolute;
      left: 50%;
      top: 140px;
      transform: translateX(-50%);
      font-size: 3rem;
      color: #ffe100;
      font-weight: bold;
      text-shadow: 0 0 12px #000, 0 0 6px #00eaff;
      pointer-events: none;
      z-index: 10;
      animation: pop 1s ease;
    }
    @keyframes pop {
      0% { opacity: 0; transform: translateX(-50%) scale(0.7);}
      20% { opacity: 1; transform: translateX(-50%) scale(1.18);}
      60% { opacity: 1;}
      100% {opacity: 0; transform: translateX(-50%) scale(1);}
    }
    @media (max-width: 520px) {
      canvas {
        width: 98vw !important;
        height: auto !important;
      }
      h2 {
        font-size: 1.3rem;
      }
    }
  </style>
</head>
<body>
  <div class="container" style="position:relative;">
    <h2>Cricket Game</h2>
    <div class="info" id="scoreInfo">Score: 0</div>
    <button class="game-btn" id="restart">Restart</button>
    <div id="runAnnounce" class="run-announce" style="display:none;"></div>
    <canvas id="game" width="600" height="600" tabindex="1"></canvas>
  </div>
  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    const scoreInfo = document.getElementById("scoreInfo");
    const restartBtn = document.getElementById("restart");
    const runAnnounce = document.getElementById("runAnnounce");

    const FIELD_CX = 300, FIELD_CY = 300;
    const FIELD_RADIUS = 260;
    const PITCH_LENGTH = 240;
    const PITCH_WIDTH = 38;
    const PITCH_X1 = FIELD_CX - PITCH_LENGTH / 2;
    const PITCH_X2 = FIELD_CX + PITCH_LENGTH / 2;
    const PITCH_Y = FIELD_CY - PITCH_WIDTH / 2;

    const BAT_W = 10, BAT_H = 35, BAT_X = PITCH_X2 - 18, BAT_Y = FIELD_CY;
    const STUMP_Y = FIELD_CY, STUMP_X = PITCH_X2 + 8, STUMP_HEIGHT = 36, STUMP_GAP = 7;

    const BALL_START_X = PITCH_X1 + 10;
    const BALL_Y = FIELD_CY;
    const BALL_RADIUS = 12;

    const FOUR_RADIUS = FIELD_RADIUS - 38;
    const SIX_RADIUS = FIELD_RADIUS - 12;
    const BOUNDRY_WIDTH = 14;
    const SAND_WIDTH = 26;

    let score = 0, wickets = 1, gameOver = false;
    let batAngle = 0, swinging = false, runResult = '';
    let ball, ballSpeedBase = 6, ballSpeed = 6, ballsFaced = 0;
    let animFrame, lastRunTimeout = null;

    function resetBall() {
      ballSpeed = ballSpeedBase + Math.floor(ballsFaced/6)*0.5;
      ball = {
        x: BALL_START_X,
        y: BALL_Y,
        r: BALL_RADIUS,
        vx: ballSpeed,
        vy: 0,
        hit: false,
        fly: false,
        flyVx: 0,
        flyVy: 0,
        runValue: 0,
        six: false,
        four: false
      };
    }

    function resetGame() {
      score = 0;
      wickets = 1;
      gameOver = false;
      batAngle = 0;
      swinging = false;
      ballsFaced = 0;
      ballSpeedBase = 6;
      runResult = '';
      runAnnounce.style.display = "none";
      resetBall();
      updateScore();
      cancelAnimationFrame(animFrame);
      draw();
    }

    function updateScore() {
      scoreInfo.innerHTML = `Score: ${score} | Wicket: ${wickets}${gameOver ? '<span class="game-over"> Game Over!</span>' : ''}`;
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      ctx.save();
      ctx.beginPath();
      ctx.arc(FIELD_CX, FIELD_CY, FIELD_RADIUS, 0, Math.PI*2);
      ctx.fillStyle = "#e7be7e";
      ctx.shadowColor = "#e7be7e";
      ctx.shadowBlur = 4;
      ctx.fill();
      ctx.shadowBlur = 0;
      ctx.restore();

      ctx.save();
      ctx.beginPath();
      ctx.arc(FIELD_CX, FIELD_CY, FIELD_RADIUS - SAND_WIDTH, 0, Math.PI*2);
      ctx.fillStyle = "#dfc181";
      ctx.fill();
      ctx.restore();

      ctx.save();
      ctx.beginPath();
      ctx.arc(FIELD_CX, FIELD_CY, FIELD_RADIUS - SAND_WIDTH - BOUNDRY_WIDTH, 0, Math.PI*2);
      ctx.fillStyle = "#0a6b1a";
      ctx.fill();
      ctx.restore();

      ctx.save();
      ctx.beginPath();
      ctx.arc(FIELD_CX, FIELD_CY, FOUR_RADIUS, 0, Math.PI*2);
      ctx.strokeStyle = "#ffe100";
      ctx.setLineDash([8,12]);
      ctx.lineWidth = 2.5;
      ctx.stroke();
      ctx.beginPath();
      ctx.arc(FIELD_CX, FIELD_CY, SIX_RADIUS, 0, Math.PI*2);
      ctx.strokeStyle = "#00eaff";
      ctx.setLineDash([16,8]);
      ctx.lineWidth = 3.5;
      ctx.stroke();
      ctx.setLineDash([]);
      ctx.restore();

      ctx.save();
      ctx.fillStyle = "#f0e1b1";
      ctx.strokeStyle = "#00eaff";
      ctx.lineWidth = 2;
      ctx.fillRect(PITCH_X1, PITCH_Y, PITCH_LENGTH, PITCH_WIDTH);
      ctx.beginPath();
      ctx.moveTo(PITCH_X1 + 12, PITCH_Y);
      ctx.lineTo(PITCH_X1 + 12, PITCH_Y + PITCH_WIDTH);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(PITCH_X2 - 12, PITCH_Y);
      ctx.lineTo(PITCH_X2 - 12, PITCH_Y + PITCH_WIDTH);
      ctx.stroke();
      ctx.restore();

      ctx.save();
      ctx.strokeStyle = "#fff";
      ctx.lineWidth = 5;
      for (let i = -1; i <= 1; i++) {
        ctx.beginPath();
        ctx.moveTo(STUMP_X + i * STUMP_GAP, STUMP_Y - STUMP_HEIGHT/2);
        ctx.lineTo(STUMP_X + i * STUMP_GAP, STUMP_Y + STUMP_HEIGHT/2);
        ctx.stroke();
      }
      ctx.strokeStyle = "#ffe100";
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(STUMP_X - STUMP_GAP, STUMP_Y - STUMP_HEIGHT/2 - 2);
      ctx.lineTo(STUMP_X, STUMP_Y - STUMP_HEIGHT/2 - 7);
      ctx.lineTo(STUMP_X + STUMP_GAP, STUMP_Y - STUMP_HEIGHT/2 - 2);
      ctx.stroke();
      ctx.restore();

      drawBat();
      drawBall();
      updateScore();

      if (!gameOver) {
        update();
        animFrame = requestAnimationFrame(draw);
      }
    }

    function drawBat() {
      ctx.save();
      ctx.translate(BAT_X, BAT_Y);
      ctx.rotate(batAngle);
      ctx.fillStyle = "#00eaff";
      ctx.shadowColor = "#00eaff";
      ctx.shadowBlur = 8;
      ctx.fillRect(-BAT_W/2, -BAT_H/2, BAT_W, BAT_H);
      ctx.shadowBlur = 0;
      ctx.restore();
    }

    function drawBall() {
      ctx.save();
      ctx.shadowColor = "#ffe100";
      ctx.shadowBlur = 7;
      ctx.beginPath();
      ctx.arc(ball.x, ball.y, ball.r, 0, 2 * Math.PI);
      ctx.fillStyle = "#ffe100";
      ctx.fill();
      ctx.shadowBlur = 0;
      ctx.restore();
    }

    function swingBat() {
      if (gameOver || swinging) return;
      swinging = true;
      let swingFrames = 0;
      function animateSwing() {
        swingFrames++;
        batAngle = -Math.PI/5 * Math.sin(Math.PI * swingFrames / 8);
        if (swingFrames < 8) {
          requestAnimationFrame(animateSwing);
        } else {
          batAngle = 0;
          swinging = false;
        }
      }
      animateSwing();

      if (
        !ball.hit &&
        Math.abs(ball.x - BAT_X) < 18 &&
        Math.abs(ball.y - BAT_Y) < 32 &&
        !ball.fly
      ) {
        ball.hit = true;
        ball.fly = true;
        let swingAngle = ((ball.y - BAT_Y) / 40) * Math.PI/6;
        let power = 1.2 + Math.random()*0.6;
        ball.flyVx = Math.cos(swingAngle) * 13 * power;
        ball.flyVy = Math.sin(swingAngle) * 10 * power;
        let distance = Math.sqrt(ball.flyVx*ball.flyVx + ball.flyVy*ball.flyVy) * 18;
        let landRadius = Math.min(FIELD_RADIUS-20, distance+70+Math.random()*20);
        if (landRadius > SIX_RADIUS) {
          ball.runValue = 6;
          ball.six = true;
          ball.four = false;
        } else if (landRadius > FOUR_RADIUS) {
          ball.runValue = 4;
          ball.six = false;
          ball.four = true;
        } else {
          ball.runValue = 1;
          ball.six = false;
          ball.four = false;
        }
      }
    }

    function update() {
      if (!ball.hit && !ball.fly) {
        ball.x += ball.vx;
        if (
          ball.x + ball.r > STUMP_X - STUMP_GAP * 1.5 &&
          ball.x - ball.r < STUMP_X + STUMP_GAP * 1.5 &&
          ball.y + ball.r > STUMP_Y - STUMP_HEIGHT/2 &&
          ball.y - ball.r < STUMP_Y + STUMP_HEIGHT/2
        ) {
          wickets = 0;
          gameOver = true;
          showRunResult("Bowled!");
          setTimeout(draw, 30);
          ball.hit = true;
        }
        if (ball.x >= BAT_X + 18 && !ball.hit && !gameOver) {
          ballsFaced++;
          showRunResult("Missed!");
          setTimeout(resetBall, 900);
          ball.hit = true;
        }
      } else if (ball.fly) {
        ball.x += ball.flyVx;
        ball.y += ball.flyVy;
        ball.flyVx *= 0.985;
        ball.flyVy *= 0.985;
        let dist = Math.sqrt(
          (ball.x - FIELD_CX)*(ball.x - FIELD_CX) +
          (ball.y - FIELD_CY)*(ball.y - FIELD_CY)
        );
        if (dist > FIELD_RADIUS - 10) {
          ballsFaced++;
          score += ball.runValue;
          let msg = ball.runValue === 6 ? "SIX!" : ball.runValue === 4 ? "FOUR!" : "+1 Run";
          showRunResult(msg);
          setTimeout(resetBall, 1100);
          ball.fly = false;
        }
        if (
          !ball.six && !ball.four &&
          Math.abs(ball.flyVx) < 1.5 && Math.abs(ball.flyVy) < 1.5 &&
          dist < FIELD_RADIUS - 16
        ) {
          ballsFaced++;
          score += ball.runValue;
          showRunResult("+1 Run");
          setTimeout(resetBall, 900);
          ball.fly = false;
        }
      }
    }

    function showRunResult(msg) {
      runResult = msg;
      runAnnounce.textContent = msg;
      runAnnounce.style.display = "block";
      if (lastRunTimeout) clearTimeout(lastRunTimeout);
      lastRunTimeout = setTimeout(() => {
        runAnnounce.style.display = "none";
      }, 950);
    }

    canvas.addEventListener("click", swingBat);
    window.addEventListener("keydown", e => {
      if (e.code === "Space") swingBat();
      if (e.key === "r") resetGame();
    });
    restartBtn.onclick = resetGame;

    function resize() {
      let w = Math.min(600, window.innerWidth * 0.98);
      canvas.style.width = w + "px";
      canvas.style.height = w + "px";
    }
    window.addEventListener("resize", resize);
    resize();

    if (!CanvasRenderingContext2D.prototype.roundRect) {
      CanvasRenderingContext2D.prototype.roundRect = function(x, y, w, h, r) {
        this.beginPath();
        this.moveTo(x + r, y);
        this.arcTo(x + w, y, x + w, y + h, r);
        this.arcTo(x + w, y + h, x, y + h, r);
        this.arcTo(x, y + h, x, y, r);
        this.arcTo(x, y, x + w, y, r);
        this.closePath();
      };
    }

    resetGame();
  </script>
</body>
</html>
